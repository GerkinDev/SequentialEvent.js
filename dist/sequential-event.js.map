{"version":3,"sources":["sequential-event.js"],"names":["f","exports","module","define","amd","g","window","global","self","SequentialEvent","e","t","n","r","s","o","u","a","require","i","Error","code","l","call","length","process","EventEmitter","emitHandlers","handlers","object","args","emitHandler","handlersLength","sourcePromise","Promise","resolve","reject","getNextPromise","prevResolve","stepArgs","concat","slice","newPromise","then","catch","handler","retVal","apply","constructor","type","needDomainExit","doError","events","_events","error","domain","er","arguments","domainEmitter","domainThrown","emit","err","context","enter","retPromise","exit","_maxListeners","undefined","prototype","defaultMaxListeners","setMaxListeners","isNumber","isNaN","TypeError","len","listeners","isObject","isUndefined","isFunction","Array","addListener","listener","m","newListener","push","warned","console","trace","on","once","fired","removeListener","list","position","splice","removeAllListeners","key","ret","listenerCount","evlistener","emitter","arg","cachedSetTimeout","cachedClearTimeout","defaultSetTimout","defaultClearTimeout","setTimeout","clearTimeout","runTimeout","fun","runClearTimeout","marker","queue","draining","currentQueue","queueIndex","cleanUpNextTick","drainQueue","timeout","run","nextTick","Item","array","title","browser","env","argv","version","versions","noop","off","prependListener","prependOnceListener","name","binding","cwd","chdir","dir","umask"],"mappings":"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","file":"sequential-event.js","sourcesContent":["(function(f){if(typeof exports===\"object\"&&typeof module!==\"undefined\"){module.exports=f()}else if(typeof define===\"function\"&&define.amd){define([],f)}else{var g;if(typeof window!==\"undefined\"){g=window}else if(typeof global!==\"undefined\"){g=global}else if(typeof self!==\"undefined\"){g=self}else{g=this}g.SequentialEvent = f()}})(function(){var define,module,exports;return (function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require==\"function\"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error(\"Cannot find module '\"+o+\"'\");throw f.code=\"MODULE_NOT_FOUND\",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require==\"function\"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})({1:[function(require,module,exports){\n(function (process){\n'use strict';\n\n/**\n * @file File defining the SequentialEvent class\n * @licence GPLv3\n * @author Gerkin\n */\n\nconst EventEmitter = require( 'events' ).EventEmitter;\n\n/**\n * Handle execution of all handlers in sequence\n * @param\t{Function|Function[]}\thandlers\tFunction(s) to execute. Each function may return a Promise\n * @param\t{EventEmitter}\t\t\tobject\t\tObjecto call event on\n * @param\t{Any[]}\t\t\t\t\t[args]\t\tArguments to pass to each called function\n * @returns\t{Promise}\t\t\t\tPromise resolved once each function is executed\n * @author Gerkin\n * @private\n */\nfunction emitHandlers( handlers, object, args ) {\n\t// Check if the provided handler is a single function or an array of functions\n\tif ( 'function' === typeof handlers ) {\n\t\treturn emitHandler( handlers, object, args );\n\t} else {\n\t\tlet i = 0;\n\t\tconst handlersLength = handlers.length;\n\n\t\tconst sourcePromise = new Promise(( resolve, reject ) => {\n\t\t\t/**\n\t\t\t * Generate next promise for sequence\n\t\t\t * @param\t{Any}\tprevResolve\tPrevious event chain resolved value\n\t\t\t * @returns\t{undefined}\n\t\t\t * @author Gerkin\n\t\t\t * @private\n\t\t\t */\n\t\t\tfunction getNextPromise( prevResolve ) {\n\t\t\t\tif ( i < handlersLength ) {\n\t\t\t\t\tconst stepArgs = 'undefined' !== typeof prevResolve ? args.concat([ prevResolve ]) : args.slice( 0 );\n\t\t\t\t\tconst newPromise = emitHandler( handlers[i], object, stepArgs );\n\t\t\t\t\tnewPromise.then( getNextPromise ).catch( reject );\n\t\t\t\t\ti++;\n\t\t\t\t} else {\n\t\t\t\t\treturn resolve.call( null, prevResolve );\n\t\t\t\t}\n\t\t\t}\n\t\t\tgetNextPromise();\n\t\t});\n\t\treturn sourcePromise;\n\t}\n}\n\n/**\n * Handle execution of a single handler\n * @param\t{Function}\t\thandler\tFunction to execute. It may return a Promise\n * @param\t{EventEmitter}\tobject\tObject to call event on\n * @param\t{Any[]}\t\t\t[args]\tArguments to pass to each called function\n * @returns\t{Promise}\t\tPromise resolved once this function is done\n * @author Gerkin\n * @private\n */\nfunction emitHandler( handler, object, args ) {\n\ttry {\n\t\tconst retVal = handler.apply( object, args );\n\t\tif ( 'object' === typeof retVal && Promise === retVal.constructor ) {\n\t\t\treturn retVal;\n\t\t} else {\n\t\t\treturn Promise.resolve( retVal );\n\t\t}\n\t} catch ( e ) {\n\t\treturn Promise.reject( e );\n\t}\n}\n\n/**\n * @classdesc Event emitter that guarantees sequential execution of handlers. Each handler may return a **Promise**\n * @extends EventEmitter\n * @see {@link https://nodejs.org/api/events.html Node EventEmitter}\n */\nclass SequentialEvent extends EventEmitter {\n\t/**\n\t * Constructs a new SequentialEvent\n\t * @author Gerkin\n\t */\n\tconstructor() {\n\t\tsuper();\n\t}\n\n\t/**\n\t * SequentialEvents each corresponding handlers in sequence\n\t * @param   {Any}\t\t\t\ttype\t\tName of the event to sequential-event\n\t * @param   {Any[]}\t\t\t\t[args...]\tParameters to pass to handlers\n\t * @returns\t{boolean|Promise}\tfalse if no handlers found or an error occured. Otherwise, returns a Promise resolved when then chain is done\n\t * @author Gerkin\n\t */\n\temit( type, ...args ) {\n\t\tlet needDomainExit = false;\n\t\tlet doError = ( 'error' === type );\n\n\t\tconst events = this._events;\n\t\tif ( events ) {\n\t\t\tdoError = ( doError && null == events.error );\n\t\t} else if ( !doError ) {\n\t\t\treturn false;\n\t\t}\n\n\t\tconst domain = this.domain;\n\n\t\t// If there is no 'error' event listener then throw.\n\t\tif ( doError ) {\n\t\t\tlet er;\n\t\t\tif ( arguments.length > 1 ) {\n\t\t\t\ter = arguments[1];\n\t\t\t}\n\t\t\tif ( domain ) {\n\t\t\t\tif ( !er ) {\n\t\t\t\t\ter = new Error( 'Unhandled \"error\" event' );\n\t\t\t\t}\n\t\t\t\tif ( 'object' === typeof er && er !== null ) {\n\t\t\t\t\ter.domainEmitter = this;\n\t\t\t\t\ter.domain = domain;\n\t\t\t\t\ter.domainThrown = false;\n\t\t\t\t}\n\t\t\t\tdomain.emit( 'error', er );\n\t\t\t} else if ( er instanceof Error ) {\n\t\t\t\tthrow er; // Unhandled 'error' event\n\t\t\t} else {\n\t\t\t\t// At least give some kind of context to the user\n\t\t\t\tconst err = new Error( `Unhandled \"error\" event. (${  er  })` );\n\t\t\t\terr.context = er;\n\t\t\t\tthrow err;\n\t\t\t}\n\t\t\treturn false;\n\t\t}\n\n\t\tconst handler = events[type];\n\n\t\tif ( !handler ) {\n\t\t\treturn false;\n\t\t}\n\n\t\tif ( 'undefined' !== typeof process && domain && this !== process ) {\n\t\t\tdomain.enter();\n\t\t\tneedDomainExit = true;\n\t\t}\n\n\t\tconst retPromise = emitHandlers( handler, this, args );\n\n\t\tif ( needDomainExit ) {\n\t\t\tdomain.exit();\n\t\t}\n\n\t\treturn retPromise;\n\t}\n}\n\nmodule.exports = SequentialEvent;\n\n}).call(this,require('_process'))\n},{\"_process\":3,\"events\":2}],2:[function(require,module,exports){\n// Copyright Joyent, Inc. and other Node contributors.\n//\n// Permission is hereby granted, free of charge, to any person obtaining a\n// copy of this software and associated documentation files (the\n// \"Software\"), to deal in the Software without restriction, including\n// without limitation the rights to use, copy, modify, merge, publish,\n// distribute, sublicense, and/or sell copies of the Software, and to permit\n// persons to whom the Software is furnished to do so, subject to the\n// following conditions:\n//\n// The above copyright notice and this permission notice shall be included\n// in all copies or substantial portions of the Software.\n//\n// THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS\n// OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF\n// MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN\n// NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM,\n// DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR\n// OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE\n// USE OR OTHER DEALINGS IN THE SOFTWARE.\n\nfunction EventEmitter() {\n  this._events = this._events || {};\n  this._maxListeners = this._maxListeners || undefined;\n}\nmodule.exports = EventEmitter;\n\n// Backwards-compat with node 0.10.x\nEventEmitter.EventEmitter = EventEmitter;\n\nEventEmitter.prototype._events = undefined;\nEventEmitter.prototype._maxListeners = undefined;\n\n// By default EventEmitters will print a warning if more than 10 listeners are\n// added to it. This is a useful default which helps finding memory leaks.\nEventEmitter.defaultMaxListeners = 10;\n\n// Obviously not all Emitters should be limited to 10. This function allows\n// that to be increased. Set to zero for unlimited.\nEventEmitter.prototype.setMaxListeners = function(n) {\n  if (!isNumber(n) || n < 0 || isNaN(n))\n    throw TypeError('n must be a positive number');\n  this._maxListeners = n;\n  return this;\n};\n\nEventEmitter.prototype.emit = function(type) {\n  var er, handler, len, args, i, listeners;\n\n  if (!this._events)\n    this._events = {};\n\n  // If there is no 'error' event listener then throw.\n  if (type === 'error') {\n    if (!this._events.error ||\n        (isObject(this._events.error) && !this._events.error.length)) {\n      er = arguments[1];\n      if (er instanceof Error) {\n        throw er; // Unhandled 'error' event\n      } else {\n        // At least give some kind of context to the user\n        var err = new Error('Uncaught, unspecified \"error\" event. (' + er + ')');\n        err.context = er;\n        throw err;\n      }\n    }\n  }\n\n  handler = this._events[type];\n\n  if (isUndefined(handler))\n    return false;\n\n  if (isFunction(handler)) {\n    switch (arguments.length) {\n      // fast cases\n      case 1:\n        handler.call(this);\n        break;\n      case 2:\n        handler.call(this, arguments[1]);\n        break;\n      case 3:\n        handler.call(this, arguments[1], arguments[2]);\n        break;\n      // slower\n      default:\n        args = Array.prototype.slice.call(arguments, 1);\n        handler.apply(this, args);\n    }\n  } else if (isObject(handler)) {\n    args = Array.prototype.slice.call(arguments, 1);\n    listeners = handler.slice();\n    len = listeners.length;\n    for (i = 0; i < len; i++)\n      listeners[i].apply(this, args);\n  }\n\n  return true;\n};\n\nEventEmitter.prototype.addListener = function(type, listener) {\n  var m;\n\n  if (!isFunction(listener))\n    throw TypeError('listener must be a function');\n\n  if (!this._events)\n    this._events = {};\n\n  // To avoid recursion in the case that type === \"newListener\"! Before\n  // adding it to the listeners, first emit \"newListener\".\n  if (this._events.newListener)\n    this.emit('newListener', type,\n              isFunction(listener.listener) ?\n              listener.listener : listener);\n\n  if (!this._events[type])\n    // Optimize the case of one listener. Don't need the extra array object.\n    this._events[type] = listener;\n  else if (isObject(this._events[type]))\n    // If we've already got an array, just append.\n    this._events[type].push(listener);\n  else\n    // Adding the second element, need to change to array.\n    this._events[type] = [this._events[type], listener];\n\n  // Check for listener leak\n  if (isObject(this._events[type]) && !this._events[type].warned) {\n    if (!isUndefined(this._maxListeners)) {\n      m = this._maxListeners;\n    } else {\n      m = EventEmitter.defaultMaxListeners;\n    }\n\n    if (m && m > 0 && this._events[type].length > m) {\n      this._events[type].warned = true;\n      console.error('(node) warning: possible EventEmitter memory ' +\n                    'leak detected. %d listeners added. ' +\n                    'Use emitter.setMaxListeners() to increase limit.',\n                    this._events[type].length);\n      if (typeof console.trace === 'function') {\n        // not supported in IE 10\n        console.trace();\n      }\n    }\n  }\n\n  return this;\n};\n\nEventEmitter.prototype.on = EventEmitter.prototype.addListener;\n\nEventEmitter.prototype.once = function(type, listener) {\n  if (!isFunction(listener))\n    throw TypeError('listener must be a function');\n\n  var fired = false;\n\n  function g() {\n    this.removeListener(type, g);\n\n    if (!fired) {\n      fired = true;\n      listener.apply(this, arguments);\n    }\n  }\n\n  g.listener = listener;\n  this.on(type, g);\n\n  return this;\n};\n\n// emits a 'removeListener' event iff the listener was removed\nEventEmitter.prototype.removeListener = function(type, listener) {\n  var list, position, length, i;\n\n  if (!isFunction(listener))\n    throw TypeError('listener must be a function');\n\n  if (!this._events || !this._events[type])\n    return this;\n\n  list = this._events[type];\n  length = list.length;\n  position = -1;\n\n  if (list === listener ||\n      (isFunction(list.listener) && list.listener === listener)) {\n    delete this._events[type];\n    if (this._events.removeListener)\n      this.emit('removeListener', type, listener);\n\n  } else if (isObject(list)) {\n    for (i = length; i-- > 0;) {\n      if (list[i] === listener ||\n          (list[i].listener && list[i].listener === listener)) {\n        position = i;\n        break;\n      }\n    }\n\n    if (position < 0)\n      return this;\n\n    if (list.length === 1) {\n      list.length = 0;\n      delete this._events[type];\n    } else {\n      list.splice(position, 1);\n    }\n\n    if (this._events.removeListener)\n      this.emit('removeListener', type, listener);\n  }\n\n  return this;\n};\n\nEventEmitter.prototype.removeAllListeners = function(type) {\n  var key, listeners;\n\n  if (!this._events)\n    return this;\n\n  // not listening for removeListener, no need to emit\n  if (!this._events.removeListener) {\n    if (arguments.length === 0)\n      this._events = {};\n    else if (this._events[type])\n      delete this._events[type];\n    return this;\n  }\n\n  // emit removeListener for all listeners on all events\n  if (arguments.length === 0) {\n    for (key in this._events) {\n      if (key === 'removeListener') continue;\n      this.removeAllListeners(key);\n    }\n    this.removeAllListeners('removeListener');\n    this._events = {};\n    return this;\n  }\n\n  listeners = this._events[type];\n\n  if (isFunction(listeners)) {\n    this.removeListener(type, listeners);\n  } else if (listeners) {\n    // LIFO order\n    while (listeners.length)\n      this.removeListener(type, listeners[listeners.length - 1]);\n  }\n  delete this._events[type];\n\n  return this;\n};\n\nEventEmitter.prototype.listeners = function(type) {\n  var ret;\n  if (!this._events || !this._events[type])\n    ret = [];\n  else if (isFunction(this._events[type]))\n    ret = [this._events[type]];\n  else\n    ret = this._events[type].slice();\n  return ret;\n};\n\nEventEmitter.prototype.listenerCount = function(type) {\n  if (this._events) {\n    var evlistener = this._events[type];\n\n    if (isFunction(evlistener))\n      return 1;\n    else if (evlistener)\n      return evlistener.length;\n  }\n  return 0;\n};\n\nEventEmitter.listenerCount = function(emitter, type) {\n  return emitter.listenerCount(type);\n};\n\nfunction isFunction(arg) {\n  return typeof arg === 'function';\n}\n\nfunction isNumber(arg) {\n  return typeof arg === 'number';\n}\n\nfunction isObject(arg) {\n  return typeof arg === 'object' && arg !== null;\n}\n\nfunction isUndefined(arg) {\n  return arg === void 0;\n}\n\n},{}],3:[function(require,module,exports){\n// shim for using process in browser\nvar process = module.exports = {};\n\n// cached from whatever global is present so that test runners that stub it\n// don't break things.  But we need to wrap it in a try catch in case it is\n// wrapped in strict mode code which doesn't define any globals.  It's inside a\n// function because try/catches deoptimize in certain engines.\n\nvar cachedSetTimeout;\nvar cachedClearTimeout;\n\nfunction defaultSetTimout() {\n    throw new Error('setTimeout has not been defined');\n}\nfunction defaultClearTimeout () {\n    throw new Error('clearTimeout has not been defined');\n}\n(function () {\n    try {\n        if (typeof setTimeout === 'function') {\n            cachedSetTimeout = setTimeout;\n        } else {\n            cachedSetTimeout = defaultSetTimout;\n        }\n    } catch (e) {\n        cachedSetTimeout = defaultSetTimout;\n    }\n    try {\n        if (typeof clearTimeout === 'function') {\n            cachedClearTimeout = clearTimeout;\n        } else {\n            cachedClearTimeout = defaultClearTimeout;\n        }\n    } catch (e) {\n        cachedClearTimeout = defaultClearTimeout;\n    }\n} ())\nfunction runTimeout(fun) {\n    if (cachedSetTimeout === setTimeout) {\n        //normal enviroments in sane situations\n        return setTimeout(fun, 0);\n    }\n    // if setTimeout wasn't available but was latter defined\n    if ((cachedSetTimeout === defaultSetTimout || !cachedSetTimeout) && setTimeout) {\n        cachedSetTimeout = setTimeout;\n        return setTimeout(fun, 0);\n    }\n    try {\n        // when when somebody has screwed with setTimeout but no I.E. maddness\n        return cachedSetTimeout(fun, 0);\n    } catch(e){\n        try {\n            // When we are in I.E. but the script has been evaled so I.E. doesn't trust the global object when called normally\n            return cachedSetTimeout.call(null, fun, 0);\n        } catch(e){\n            // same as above but when it's a version of I.E. that must have the global object for 'this', hopfully our context correct otherwise it will throw a global error\n            return cachedSetTimeout.call(this, fun, 0);\n        }\n    }\n\n\n}\nfunction runClearTimeout(marker) {\n    if (cachedClearTimeout === clearTimeout) {\n        //normal enviroments in sane situations\n        return clearTimeout(marker);\n    }\n    // if clearTimeout wasn't available but was latter defined\n    if ((cachedClearTimeout === defaultClearTimeout || !cachedClearTimeout) && clearTimeout) {\n        cachedClearTimeout = clearTimeout;\n        return clearTimeout(marker);\n    }\n    try {\n        // when when somebody has screwed with setTimeout but no I.E. maddness\n        return cachedClearTimeout(marker);\n    } catch (e){\n        try {\n            // When we are in I.E. but the script has been evaled so I.E. doesn't  trust the global object when called normally\n            return cachedClearTimeout.call(null, marker);\n        } catch (e){\n            // same as above but when it's a version of I.E. that must have the global object for 'this', hopfully our context correct otherwise it will throw a global error.\n            // Some versions of I.E. have different rules for clearTimeout vs setTimeout\n            return cachedClearTimeout.call(this, marker);\n        }\n    }\n\n\n\n}\nvar queue = [];\nvar draining = false;\nvar currentQueue;\nvar queueIndex = -1;\n\nfunction cleanUpNextTick() {\n    if (!draining || !currentQueue) {\n        return;\n    }\n    draining = false;\n    if (currentQueue.length) {\n        queue = currentQueue.concat(queue);\n    } else {\n        queueIndex = -1;\n    }\n    if (queue.length) {\n        drainQueue();\n    }\n}\n\nfunction drainQueue() {\n    if (draining) {\n        return;\n    }\n    var timeout = runTimeout(cleanUpNextTick);\n    draining = true;\n\n    var len = queue.length;\n    while(len) {\n        currentQueue = queue;\n        queue = [];\n        while (++queueIndex < len) {\n            if (currentQueue) {\n                currentQueue[queueIndex].run();\n            }\n        }\n        queueIndex = -1;\n        len = queue.length;\n    }\n    currentQueue = null;\n    draining = false;\n    runClearTimeout(timeout);\n}\n\nprocess.nextTick = function (fun) {\n    var args = new Array(arguments.length - 1);\n    if (arguments.length > 1) {\n        for (var i = 1; i < arguments.length; i++) {\n            args[i - 1] = arguments[i];\n        }\n    }\n    queue.push(new Item(fun, args));\n    if (queue.length === 1 && !draining) {\n        runTimeout(drainQueue);\n    }\n};\n\n// v8 likes predictible objects\nfunction Item(fun, array) {\n    this.fun = fun;\n    this.array = array;\n}\nItem.prototype.run = function () {\n    this.fun.apply(null, this.array);\n};\nprocess.title = 'browser';\nprocess.browser = true;\nprocess.env = {};\nprocess.argv = [];\nprocess.version = ''; // empty string to avoid regexp issues\nprocess.versions = {};\n\nfunction noop() {}\n\nprocess.on = noop;\nprocess.addListener = noop;\nprocess.once = noop;\nprocess.off = noop;\nprocess.removeListener = noop;\nprocess.removeAllListeners = noop;\nprocess.emit = noop;\nprocess.prependListener = noop;\nprocess.prependOnceListener = noop;\n\nprocess.listeners = function (name) { return [] }\n\nprocess.binding = function (name) {\n    throw new Error('process.binding is not supported');\n};\n\nprocess.cwd = function () { return '/' };\nprocess.chdir = function (dir) {\n    throw new Error('process.chdir is not supported');\n};\nprocess.umask = function() { return 0; };\n\n},{}]},{},[1])(1)\n});"]}